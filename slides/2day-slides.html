<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Transport + Geographic Data Science with R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Robin Lovelace and Malcolm Morgan" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/leaflet/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet/leaflet.js"></script>
    <link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
    <script src="libs/Proj4Leaflet/proj4-compressed.js"></script>
    <script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding/leaflet.js"></script>
    <script src="libs/leaflet-providers/leaflet-providers.js"></script>
    <script src="libs/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Transport + Geographic Data Science with R
## <br/>2 day course
### Robin Lovelace and Malcolm Morgan
### University of Leeds, 2019-05-02<br/><img class="img-footer" alt="" src="http://www.stephanehess.me.uk/images/picture3.png">

---


background-image: url(https://c1.staticflickr.com/2/1216/1096671706_571a263b63_b.jpg)
background-position: 50% 50%
class: center, bottom, inverse

# Credit: Mandeep Lota via [flickr](https://www.flickr.com/photos/deepster2k/1096671706)



---

# The team

### Robin Lovelace

- Especially cycling potential ([e.g. to school](http://eprints.whiterose.ac.uk/141852/))
- R developer and teacher, with three books on the subject 
- Lead Developer of the Propensity to Cycle Tool ([PCT](http://www.pct.bike/)) and PI on the Cycling Infrastructure Prioritisation Toolkit ([CyIPT](https://www.cyipt.bike))

--

### Malcolm Morgan

- Civil Engineer by training
- Moved into transport via the Propensity to Cycle Tool Project
- Expertise in machine learning and routing
- Focus on multi-modal routing and energy use (UKERC)

--

### How about you?

---

## Housekeeping

- The venue + facilities
- The agenda + further info can be found on the course website:
- git.io/tds2day



---

## Learning outcomes

By the end of the course, you will be able to:

- Find, download and import a variety of transport datasets, including from OpenStreetMap and government data portals
- Work with, analyse and model transport data with spatial, temporal and demographic attributes
- Generate and analyse route networks for transport planning with reference to:
    - Origin-destination (OD) data
    - Geographic desire lines
    - Route allocation using different routing services
    - Route network generation and analysis
---


background-image: url(https://media.giphy.com/media/5FZNmBHhoozLO/giphy.gif)
background-size: cover
class: center, middle

# Set-up

--

## Effective use of R/RStudio

---

# Using packages: example with sf/ggplot2

- See Efficient R Programming, Section [4.4](https://csgillespie.github.io/efficientR/workflow.html#package-selection), and R4DS, Chapter [2](https://r4ds.had.co.nz/data-visualisation.html)


```r
d = data.frame(x = 1:9, y = (1:9)^2)
plot(d)           # base R
library(ggplot2)  # with a package
ggplot(d) +
  geom_point(aes(x, y))
```

&lt;img src="2day-slides_files/figure-html/unnamed-chunk-2-1.png" width="30%" /&gt;&lt;img src="2day-slides_files/figure-html/unnamed-chunk-2-2.png" width="30%" /&gt;

---

## What is transport data science?

- The application of data science to transport datasets and problems

--

- Raising the question...

--

- What is data science?

&lt;!-- You tell me! --&gt;

--

- A discipline "that allows you to turn raw data into understanding, insight, and knowledge" (Grolemund and Wickham, 2016)

--

In other words...

- Statistics that is actually useful!

---

## A geographic perspective

- See https://github.com/ITSLeeds/TDS/blob/master/catalogue.md

- Paper on the **stplanr** paper for transport planning (available [online](https://cran.r-project.org/web/packages/stplanr/vignettes/stplanr-paper.html)) (Lovelace and Ellison, 2017)
- Introductory and advanced content on geographic data in R, especially the [transport chapter](http://geocompr.robinlovelace.net/transport.html) (available free [online](http://geocompr.robinlovelace.net/)) (Lovelace, Nowosad, and Meunchow, 2018) 
- Paper on analysing OSM data in Python (Boeing, 2017) (available [online](https://arxiv.org/pdf/1611.01890)) 

&lt;img src="https://geocompr.robinlovelace.net/images/cover.png" width="20%" /&gt;

---


## Data science and the tidyverse

- Inspired by Introduction to data science with R (available free [online](http://r4ds.had.co.nz/)) (Grolemund and Wickham, 2016)


&lt;img src="https://d33wubrfki0l68.cloudfront.net/b88ef926a004b0fce72b2526b0b5c4413666a4cb/24a30/cover.png" width="30%" /&gt;

---

## Transport software options

&lt;table&gt;
&lt;caption&gt;Sample of transport modelling software in use by practitioners. Note: citation counts based on searches for company/developer name, the product name and 'transport'. Data source: Google Scholar searches, October 2018.&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Software &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Company/Developer &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Company HQ &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Licence &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Citations &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Visum &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PTV &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Germany &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Proprietary &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1810 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; MATSim &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; TU Berlin &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Germany &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Open source (GPL) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1470 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; TransCAD &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Caliper &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Proprietary &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1360 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; SUMO &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; DLR &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Germany &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Open source (EPL) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1310 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Emme &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; INRO &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Proprietary &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 780 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Cube &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Citilabs &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Proprietary &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 400 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; sDNA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Cardiff University &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; UK &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Proprietary &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 170 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Getting help online

- [gis.stackexchange.com](https://gis.stackexchange.com/questions) has 21,314 questions 

- [r-sig-geo](http://r-sig-geo.2731867.n2.nabble.com/) has 1000s of posts

- RStudio's Discourse community has 65,000+ posts already!

--

- No transport equivalent (e.g. earthscience.stackexchange.com is in beta)

- Potential for a Discourse forum or similar: transport is not (just) GIS

---

## How is data science used in the PCT?

- It's all reproducible, e.g.:
- Find short in which more people drive than cycle

--

- Stage 1: get data from web





```r
# Set-up, after installing pct and checking out www.pct.bike:
library(dplyr)
library(sf)
desire_lines_all = pct::get_pct_lines(region = "isle-of-wight") %&gt;% 
  top_n(n = 1000, wt = all)
```

---

## Stage II: Geographic data analysis

- Interested only in top 200 lines


```r
desire_lines = desire_lines_all %&gt;% 
  top_n(n = 20, wt = all)
```


---

## Stage III: Visualising (polution) data

&lt;!-- A fundamental part of data science is being able to understand your data. --&gt;

&lt;!-- That requires visualisation, R is great for that: --&gt;




&lt;!-- - Interactively: --&gt;


```r
library(tmap)
tmap_mode("view")
tm_shape(desire_lines) +
  tm_lines("bicycle", lwd = "all", scale = 5) +
  tm_basemap(server = leaflet::providers$OpenStreetMap.BlackAndWhite)
```

<div id="htmlwidget-93a776095540519605e7" style="width:504px;height:504px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-93a776095540519605e7">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["OpenStreetMap.BlackAndWhite",null,"OpenStreetMap.BlackAndWhite",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["overlayPane01",401]},{"method":"addPolylines","args":[[[[{"lng":[-1.29751408324623,-1.31006711916123],"lat":[50.7571421447456,50.7534038592352]}]],[[{"lng":[-1.29751408324623,-1.28149160450734],"lat":[50.7571421447456,50.751845127431]}]],[[{"lng":[-1.29751408324623,-1.28428479295049],"lat":[50.7571421447456,50.7032568564458]}]],[[{"lng":[-1.29751408324623,-1.30234477290129],"lat":[50.7571421447456,50.7026730223134]}]],[[{"lng":[-1.31006711916123,-1.28428479295049],"lat":[50.7534038592352,50.7032568564458]}]],[[{"lng":[-1.31006711916123,-1.30234477290129],"lat":[50.7534038592352,50.7026730223134]}]],[[{"lng":[-1.28149160450734,-1.28428479295049],"lat":[50.751845127431,50.7032568564458]}]],[[{"lng":[-1.28149160450734,-1.30234477290129],"lat":[50.751845127431,50.7026730223134]}]],[[{"lng":[-1.15850885830822,-1.1738784568452],"lat":[50.7287388002202,50.723010861409]}]],[[{"lng":[-1.15850885830822,-1.15588435552669],"lat":[50.7287388002202,50.7218561008228]}]],[[{"lng":[-1.22406933736016,-1.28428479295049],"lat":[50.726134669078,50.7032568564458]}]],[[{"lng":[-1.15588435552669,-1.28428479295049],"lat":[50.7218561008228,50.7032568564458]}]],[[{"lng":[-1.28428479295049,-1.30234477290129],"lat":[50.7032568564458,50.7026730223134]}]],[[{"lng":[-1.28428479295049,-1.30109588996732],"lat":[50.7032568564458,50.694111412435]}]],[[{"lng":[-1.28428479295049,-1.38653729071091],"lat":[50.7032568564458,50.6816556263349]}]],[[{"lng":[-1.28428479295049,-1.18035914920938],"lat":[50.7032568564458,50.6441760538615]}]],[[{"lng":[-1.30234477290129,-1.30109588996732],"lat":[50.7026730223134,50.694111412435]}]],[[{"lng":[-1.15498622859574,-1.18035914920938],"lat":[50.6593991947347,50.6441760538615]}]],[[{"lng":[-1.15498622859574,-1.17583190156454],"lat":[50.6593991947347,50.634468081491]}]],[[{"lng":[-1.18035914920938,-1.17583190156454],"lat":[50.6441760538615,50.634468081491]}]]],["E02003581.E02003582","E02003581.E02003583","E02003581.E02003588","E02003581.E02003589","E02003582.E02003588","E02003582.E02003589","E02003583.E02003588","E02003583.E02003589","E02003584.E02003586","E02003584.E02003587","E02003585.E02003588","E02003587.E02003588","E02003588.E02003589","E02003588.E02003591","E02003588.E02003593","E02003588.E02003595","E02003589.E02003591","E02003594.E02003595","E02003594.E02003596","E02003595.E02003596"],"desire_lines",{"interactive":true,"className":"","pane":"overlayPane01","stroke":true,"color":["#DB5D0A","#DB5D0A","#DB5D0A","#FED97B","#F68820","#FEB441","#FED97B","#FED97B","#FED97B","#FEF1AF","#FFFDDB","#FEF1AF","#7A2A05","#7A2A05","#FEF1AF","#FFFDDB","#DB5D0A","#FEF1AF","#FFFDDB","#FEF1AF"],"weight":[2.65384615384615,1.78321678321678,2.38111888111888,1.63286713286713,2.52447552447552,1.86363636363636,1.90559440559441,1.56643356643357,2.16433566433566,2.48601398601399,1.70979020979021,1.5,5,3.67832167832168,1.46853146853147,1.48601398601399,3.94055944055944,1.83566433566434,1.81468531468531,2.06293706293706],"opacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"fill":false,"fillColor":["#DB5D0A","#DB5D0A","#DB5D0A","#FED97B","#F68820","#FEB441","#FED97B","#FED97B","#FED97B","#FEF1AF","#FFFDDB","#FEF1AF","#7A2A05","#7A2A05","#FEF1AF","#FFFDDB","#DB5D0A","#FEF1AF","#FFFDDB","#FEF1AF"],"fillOpacity":0.2,"dashArray":"none","smoothFactor":1,"noClip":false},["<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003581 E02003582<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>50<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>759<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003581 E02003583<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>53<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>510<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003581 E02003588<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>57<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>681<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003581 E02003589<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>27<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>467<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003582 E02003588<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>43<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>722<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003582 E02003589<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>32<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>533<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003583 E02003588<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>29<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>545<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003583 E02003589<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>21<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>448<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003584 E02003586<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>21<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>619<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003584 E02003587<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>17<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>711<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003585 E02003588<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>9<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>489<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003587 E02003588<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>10<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>429<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003588 E02003589<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>72<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>1,430<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003588 E02003591<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>71<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>1,052<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003588 E02003593<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>19<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>420<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003588 E02003595<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>3<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>425<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003589 E02003591<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>50<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>1,127<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003594 E02003595<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>18<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>525<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003594 E02003596<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>8<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>519<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003595 E02003596<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">bicycle<\/td><td>15<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>590<\/td><\/tr><\/table><\/div>"],{"maxWidth":500,"minWidth":100,"autoPan":true,"keepInView":false,"closeButton":true,"className":""},["E02003581 E02003582","E02003581 E02003583","E02003581 E02003588","E02003581 E02003589","E02003582 E02003588","E02003582 E02003589","E02003583 E02003588","E02003583 E02003589","E02003584 E02003586","E02003584 E02003587","E02003585 E02003588","E02003587 E02003588","E02003588 E02003589","E02003588 E02003591","E02003588 E02003593","E02003588 E02003595","E02003589 E02003591","E02003594 E02003595","E02003594 E02003596","E02003595 E02003596"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#FFFDDB","#FEF1AF","#FED97B","#FEB441","#F68820","#DB5D0A","#AF3E03","#7A2A05"],"labels":["0 to 10","10 to 20","20 to 30","30 to 40","40 to 50","50 to 60","60 to 70","70 to 80"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"bicycle","extra":null,"layerId":null,"className":"info legend","group":null}]},{"method":"addLayersControl","args":[[],"desire_lines",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[50.634468081491,50.7571421447456],"lng":[-1.38653729071091,-1.15498622859574]},"fitBounds":[50.634468081491,-1.38653729071091,50.7571421447456,-1.15498622859574,[]]},"evals":[],"jsHooks":[]}</script>


---

## Stage IV: Origin-destination data analysis

- Now we have data in our computer, and verified it works, we can use it

- Which places are most car dependent? 


```r
car_dependent_routes = desire_lines %&gt;% 
  mutate(percent_drive = car_driver / all * 100) %&gt;% 
  filter(rf_dist_km &lt; 3 &amp; rf_dist_km &gt; 1) 
```

- Get routes


```r
routes = stplanr::line2route(car_dependent_routes)
car_dependent_routes$geometry = routes$geometry
```





---

## Communicating results

Visualisation is vital


```r
b = c(0, 25, 50, 75)
tm_shape(car_dependent_routes) +
  tm_lines(col = "percent_drive", lwd = "all", scale = 5, breaks = b, palette = "-inferno")
```

<div id="htmlwidget-dd99b04b586ed2ce6688" style="width:504px;height:504px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-dd99b04b586ed2ce6688">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Esri.WorldGrayCanvas",null,"Esri.WorldGrayCanvas",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["overlayPane01",401]},{"method":"addPolylines","args":[[[[{"lng":[-1.29757,-1.29757,-1.29766,-1.29776,-1.29777,-1.29837,-1.29897,-1.3004,-1.30074,-1.30135,-1.30185,-1.30291,-1.30433,-1.30433,-1.30429,-1.30431,-1.30435,-1.3044,-1.3045,-1.30453,-1.30479,-1.30482,-1.30518,-1.30543,-1.30549,-1.30563,-1.30594,-1.30616,-1.30643,-1.30656,-1.30679,-1.30695,-1.30733,-1.30747,-1.30751,-1.30761,-1.30767,-1.30768,-1.30767,-1.3076,-1.30829,-1.30872,-1.30907,-1.31005],"lat":[50.75729,50.75732,50.75733,50.75733,50.75706,50.75705,50.757,50.75618,50.75608,50.75606,50.75604,50.75602,50.75598,50.75585,50.75573,50.75559,50.75554,50.75545,50.75536,50.75534,50.75526,50.75525,50.75516,50.75508,50.75507,50.75504,50.75498,50.75495,50.75494,50.75492,50.75488,50.75481,50.75463,50.75454,50.75452,50.75441,50.75428,50.75426,50.75412,50.75398,50.75387,50.75385,50.75379,50.75342]}]],[[{"lng":[-1.29757,-1.29757,-1.29766,-1.29776,-1.29777,-1.29778,-1.29754,-1.29737,-1.29703,-1.29655,-1.29607,-1.29588,-1.29552,-1.29535,-1.29503,-1.29498,-1.29472,-1.29449,-1.29428,-1.29391,-1.29385,-1.29345,-1.29343,-1.29325,-1.29306,-1.29297,-1.29254,-1.29248,-1.29044,-1.2904,-1.29036,-1.29033,-1.29032,-1.29033,-1.29034,-1.29032,-1.29029,-1.29008,-1.29004,-1.29003,-1.29002,-1.29,-1.28998,-1.28996,-1.28994,-1.28992,-1.2899,-1.28987,-1.28987,-1.28985,-1.28982,-1.28972,-1.28957,-1.28941,-1.28922,-1.28912,-1.28916,-1.28917,-1.28916,-1.28914,-1.28912,-1.28907,-1.28902,-1.28897,-1.28893,-1.2889,-1.28888,-1.28876,-1.28799,-1.28796,-1.28791,-1.28681,-1.2867,-1.28661,-1.28656,-1.28654,-1.28654,-1.28655,-1.2866,-1.28662,-1.2866,-1.28657,-1.28644,-1.2858,-1.28547,-1.2847,-1.28424,-1.28404,-1.28344,-1.28252,-1.28204,-1.2817,-1.28261,-1.28262,-1.2827,-1.28223,-1.28162,-1.28127,-1.28132,-1.28131,-1.28131,-1.2813,-1.28125,-1.28117],"lat":[50.75729,50.75732,50.75733,50.75733,50.75745,50.75769,50.7577,50.75769,50.7575,50.75756,50.75765,50.75767,50.75771,50.75772,50.75777,50.75778,50.75781,50.75786,50.75793,50.75819,50.75823,50.75851,50.7585,50.75842,50.75833,50.75829,50.75807,50.75803,50.75736,50.75735,50.75736,50.75738,50.7574,50.75747,50.75751,50.75755,50.75759,50.75777,50.7578,50.75781,50.75782,50.75784,50.75785,50.75787,50.75789,50.75791,50.75793,50.75795,50.75796,50.75798,50.758,50.75808,50.75821,50.75833,50.75848,50.75852,50.75856,50.75859,50.75862,50.75864,50.75866,50.75868,50.75868,50.75867,50.75866,50.75863,50.75859,50.75854,50.75822,50.75821,50.75819,50.75774,50.75767,50.75759,50.75749,50.7574,50.75734,50.75728,50.75712,50.75706,50.75701,50.75696,50.75686,50.75654,50.75637,50.756,50.75583,50.75577,50.75559,50.75532,50.75517,50.75507,50.75421,50.75408,50.7535,50.75346,50.75332,50.75324,50.753,50.75274,50.75253,50.75242,50.75234,50.75229]}]],[[{"lng":[-1.15853,-1.15881,-1.15937,-1.15952,-1.15975,-1.15987,-1.15995,-1.16003,-1.16011,-1.16041,-1.16134,-1.16164,-1.16184,-1.162,-1.16213,-1.16292,-1.16286,-1.16272,-1.1627,-1.16269,-1.1627,-1.16271,-1.16274,-1.16281,-1.16301,-1.16336,-1.16364,-1.16386,-1.16416,-1.16462,-1.16465,-1.16472,-1.16485,-1.16514,-1.16537,-1.16577,-1.16594,-1.16634,-1.16666,-1.16688,-1.16701,-1.1671,-1.16875,-1.16897,-1.1693,-1.16969,-1.17,-1.17172,-1.17173,-1.17167,-1.17166,-1.1719,-1.17238,-1.17304,-1.17348,-1.17399,-1.17399,-1.17399],"lat":[50.72867,50.72871,50.72879,50.72881,50.72887,50.72877,50.72866,50.72847,50.72827,50.72731,50.7275,50.72757,50.7276,50.72762,50.72762,50.72763,50.72741,50.72702,50.72695,50.72679,50.72664,50.72652,50.72642,50.72627,50.72598,50.72557,50.7253,50.7251,50.72494,50.72476,50.72474,50.7247,50.72459,50.72422,50.724,50.72369,50.72357,50.72326,50.72299,50.72278,50.72264,50.72265,50.72276,50.72277,50.72279,50.72282,50.72283,50.72276,50.72294,50.72418,50.72431,50.72429,50.72424,50.72414,50.72398,50.72378,50.72375,50.72352]}]],[[{"lng":[-1.15853,-1.15797,-1.15684,-1.15648,-1.15592,-1.15539,-1.15495,-1.15512,-1.15523,-1.15526,-1.1556,-1.15561,-1.1558,-1.15583,-1.15589,-1.15601,-1.15611,-1.15617,-1.15652,-1.15668,-1.15693,-1.15667,-1.15644,-1.15622,-1.15581,-1.15574,-1.15568,-1.15559,-1.1554,-1.15504,-1.15472,-1.15428,-1.15413,-1.15455,-1.15471,-1.15557,-1.15604],"lat":[50.72867,50.7286,50.72848,50.72844,50.72839,50.72833,50.72829,50.72779,50.72745,50.72737,50.72639,50.72637,50.72591,50.72583,50.72573,50.72556,50.72546,50.72541,50.72508,50.72493,50.7247,50.72459,50.7245,50.7244,50.72416,50.72412,50.72409,50.72403,50.72395,50.72377,50.72361,50.72339,50.72332,50.72301,50.7229,50.7223,50.72195]}]],[[{"lng":[-1.28442,-1.28438,-1.28424,-1.28414,-1.28397,-1.2855,-1.28632,-1.28639,-1.28728,-1.2874,-1.28747,-1.28756,-1.28765,-1.2878,-1.288,-1.28805,-1.28812,-1.28828,-1.28844,-1.28858,-1.28859,-1.28861,-1.28876,-1.28889,-1.28916,-1.28977,-1.29036,-1.29056,-1.29082,-1.29106,-1.2912,-1.2917,-1.29188,-1.2925,-1.29281,-1.29297,-1.29307,-1.29329,-1.29346,-1.29366,-1.29383,-1.29408,-1.29419,-1.29421,-1.29435,-1.2949,-1.295,-1.29521,-1.29561,-1.29598,-1.29627,-1.29635,-1.29673,-1.29706,-1.29739,-1.29754,-1.29764,-1.29783,-1.29796,-1.29808,-1.29819,-1.29836,-1.29865,-1.29892,-1.29934,-1.29992,-1.30019,-1.30071,-1.30116,-1.30137,-1.30142,-1.30188,-1.30209,-1.30252,-1.30273,-1.30276,-1.30224],"lat":[50.70326,50.70339,50.70373,50.7039,50.70428,50.70431,50.70432,50.7043,50.70317,50.7031,50.70307,50.70299,50.70291,50.70276,50.70256,50.70254,50.70252,50.70249,50.70247,50.70222,50.7022,50.70218,50.70208,50.70202,50.70195,50.70182,50.70169,50.70163,50.70185,50.70199,50.70206,50.70228,50.70235,50.70262,50.70274,50.70274,50.70273,50.70266,50.70261,50.70259,50.70274,50.70297,50.70313,50.70316,50.70313,50.70286,50.70281,50.70274,50.70265,50.7026,50.70258,50.70258,50.70259,50.70261,50.70261,50.70258,50.70252,50.70221,50.70226,50.70228,50.70227,50.70227,50.70228,50.70231,50.70231,50.70228,50.70227,50.70221,50.70213,50.70207,50.70205,50.70188,50.7018,50.70171,50.70168,50.70239,50.70248]}]],[[{"lng":[-1.30224,-1.30276,-1.30273,-1.30252,-1.30209,-1.30188,-1.30142,-1.30137,-1.30116,-1.30071,-1.30019,-1.29992,-1.29934,-1.29892,-1.29865,-1.29836,-1.29819,-1.29808,-1.29796,-1.29783,-1.29795,-1.29819,-1.29838,-1.29882,-1.29939,-1.29948,-1.29967,-1.29986,-1.29968,-1.29928,-1.29973,-1.2998,-1.29956,-1.29992,-1.29985,-1.30055,-1.30058,-1.30002,-1.30123,-1.30109,-1.30104,-1.3009,-1.30087,-1.30084,-1.3009,-1.30089,-1.30077,-1.30072,-1.30065,-1.30135,-1.30137,-1.30132,-1.30176,-1.30148,-1.30147,-1.30128,-1.30125,-1.30111],"lat":[50.70248,50.70239,50.70168,50.70171,50.7018,50.70188,50.70205,50.70207,50.70213,50.70221,50.70227,50.70228,50.70231,50.70231,50.70228,50.70227,50.70227,50.70228,50.70226,50.70221,50.70205,50.70184,50.70169,50.70149,50.70129,50.70125,50.70119,50.7011,50.70097,50.70068,50.70033,50.70025,50.70007,50.69984,50.6997,50.69931,50.69929,50.69888,50.69795,50.69752,50.6974,50.69713,50.6971,50.69706,50.69702,50.69701,50.69679,50.6967,50.6965,50.69602,50.69598,50.69584,50.69577,50.69506,50.69504,50.69467,50.69457,50.69411]}]],[[{"lng":[-1.18055,-1.18026,-1.18012,-1.18003,-1.17973,-1.17928,-1.17931,-1.17951,-1.17957,-1.17967,-1.18009,-1.18025,-1.18036,-1.18052,-1.18054,-1.18053,-1.18052,-1.18037,-1.18029,-1.18026,-1.18024,-1.18023,-1.18018,-1.18015,-1.18014,-1.18016,-1.18017,-1.18019,-1.1802,-1.1802,-1.1802,-1.18018,-1.18014,-1.18009,-1.18002,-1.17997,-1.17991,-1.1799,-1.1799,-1.17997,-1.17999,-1.18006,-1.18012,-1.18018,-1.18027,-1.18033,-1.18041,-1.18047,-1.18052,-1.18059,-1.1807,-1.18075,-1.18076,-1.18079,-1.18082,-1.18084,-1.18083,-1.1808,-1.18078,-1.18073,-1.18063,-1.18056,-1.18046,-1.18013,-1.17992,-1.17961,-1.17927,-1.17943,-1.17949,-1.1795,-1.17947,-1.17938,-1.17891,-1.17803,-1.17801,-1.17799,-1.17787,-1.17772,-1.17696,-1.176,-1.17598,-1.17596,-1.17597],"lat":[50.64418,50.64514,50.64516,50.64514,50.6451,50.64506,50.645,50.64422,50.64411,50.644,50.64363,50.64349,50.64339,50.64316,50.64297,50.64289,50.64277,50.64239,50.64221,50.64214,50.64207,50.64205,50.64194,50.6418,50.6417,50.64148,50.64146,50.64124,50.64116,50.64109,50.641,50.64076,50.64068,50.64057,50.64045,50.64033,50.64009,50.63994,50.63979,50.63927,50.63909,50.63862,50.63832,50.63813,50.63788,50.63763,50.63711,50.63679,50.6365,50.63599,50.63538,50.635,50.63495,50.63472,50.63446,50.63408,50.63391,50.63378,50.63374,50.63368,50.63355,50.63346,50.63334,50.63295,50.63301,50.63309,50.63319,50.63338,50.63346,50.63349,50.6335,50.63351,50.63347,50.63343,50.63343,50.63354,50.63388,50.63426,50.6342,50.63413,50.63422,50.63432,50.63447]}]]],["E02003581.E02003582","E02003581.E02003583","E02003584.E02003586","E02003584.E02003587","E02003588.E02003589","E02003589.E02003591","E02003595.E02003596"],"car_dependent_routes",{"interactive":true,"className":"","pane":"overlayPane01","stroke":true,"color":["#BB3754","#BB3754","#BB3754","#BB3754","#BB3754","#BB3754","#000004"],"weight":[2.65384615384615,1.78321678321678,2.16433566433566,2.48601398601399,5,3.94055944055944,2.06293706293706],"opacity":[1,1,1,1,1,1,1],"fill":false,"fillColor":["#BB3754","#BB3754","#BB3754","#BB3754","#BB3754","#BB3754","#000004"],"fillOpacity":0.2,"dashArray":"none","smoothFactor":1,"noClip":false},["<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003581 E02003582<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">percent_drive<\/td><td>45.32<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>759<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003581 E02003583<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">percent_drive<\/td><td>25.10<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>510<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003584 E02003586<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">percent_drive<\/td><td>37.80<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>619<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003584 E02003587<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">percent_drive<\/td><td>36.43<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>711<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003588 E02003589<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">percent_drive<\/td><td>43.01<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>1,430<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003589 E02003591<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">percent_drive<\/td><td>35.49<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>1,127<\/td><\/tr><\/table><\/div>","<div style=\"max-height:10em;overflow:auto;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>E02003595 E02003596<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">percent_drive<\/td><td>51.69<\/td><\/tr><tr><td style=\"color: #888888;\">all<\/td><td>590<\/td><\/tr><\/table><\/div>"],{"maxWidth":500,"minWidth":100,"autoPan":true,"keepInView":false,"closeButton":true,"className":""},["E02003581 E02003582","E02003581 E02003583","E02003584 E02003586","E02003584 E02003587","E02003588 E02003589","E02003589 E02003591","E02003595 E02003596"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#FCFFA4","#BB3754","#000004"],"labels":["0 to 25","25 to 50","50 to 75"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"percent_drive","extra":null,"layerId":null,"className":"info legend","group":null}]},{"method":"addLayersControl","args":[["Esri.WorldGrayCanvas","OpenStreetMap","Esri.WorldTopoMap"],"car_dependent_routes",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[50.634468081491,50.7571421447456],"lng":[-1.31006711916123,-1.15588435552669]},"fitBounds":[50.634468081491,-1.31006711916123,50.7571421447456,-1.15588435552669,[]]},"evals":[],"jsHooks":[]}</script>

---

## Upcoming...


- 09:30 - 10:00 (set-up)

- 10:00 - 11:00 How to use R/RStudio effectively (MM)

--

- 11:15 - 12:30 Using packages: example with sf/ggplot2 (RL)

- 12:30 - 13:30: lunch

- 13:30 - 14:45 Spatial data analysis (MM)

--

- 15:00 - 16:00 Visualising spatial datasets (RL)

- 16:00 - 16:30 (Q&amp;A)

--

- Any questions?

--

- Everyone happy with RStudio?

---

### Day 2:

Course times each day:

- 09:30 - 11:00 stats19 data analysis - with spatial/temporal analysis (RL)


- 11:15 - 12:30 OD data with stplanr (RL)

- 12:30 - 13:30: lunch

- 13:30 - 14:45 Local route network analysis (MM)

--

- 15:00 - 16:00 Data and methods for assessing cycling potential (RL)

- 16:00 - 16:30 (Q&amp;A)

---

# Spatial data analysis

- See Geocomputation with R, Chapter [4](https://geocompr.robinlovelace.net/spatial-operations.html)

---

# Visualising spatial datasets

- See Geocomputation with R, Chapter [8](https://geocompr.robinlovelace.net/adv-map.html)

--

- Slides: [geocompr.github.io/presentations/04_viz.html](https://geocompr.github.io/presentations/04_viz.html#1)

---

# stats19 data analysis 

- See [itsleeds.github.io/stats19](https://itsleeds.github.io/stats19/)

---

# OD data with stplanr

- See [ropensci.github.io/stplanr](https://ropensci.github.io/stplanr/)

---

# Local route network analysis

- See [itsleeds.github.io/opentripplanner](https://itsleeds.github.io/opentripplanner/)

---

# Data and methods for assessing cycling potential

- See [itsleeds.github.io/pct](https://itsleeds.github.io/pct/)


- And https://geocompr.robinlovelace.net/transport.html

---

# References

Boeing, Geoff (2017). "OSMnx: New Methods for Acquiring,
Constructing, Analyzing, and Visualizing Complex Street Networks".
In: _Computers, Environment and Urban Systems_ 65, pp. 126-139.
ISSN: 0198-9715. DOI:
[10.1016/j.compenvurbsys.2017.05.004](https://doi.org/10.1016%2Fj.compenvurbsys.2017.05.004).

Grolemund, Garrett and Hadley Wickham (2016). _R for Data
Science_. 1 edition. O'Reilly Media. ISBN: 978-1-4919-1039-9.

Lovelace, Robin and Richard Ellison (2017). "Stplanr: A Package
for Transport Planning". In: _The R Journal_.

Lovelace, Robin, Jakub Nowosad, and Jannes Meunchow (2018).
_Geocomputation with R_. CRC Press.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
